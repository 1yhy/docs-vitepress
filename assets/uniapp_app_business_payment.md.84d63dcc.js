import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.c3fd347f.js";const F=JSON.parse('{"title":"第十四集 支付","description":"","frontmatter":{},"headers":[],"relativePath":"uniapp/app/business/payment.md","filePath":"uniapp/app/business/payment.md","lastUpdated":1707147609000}'),p={name:"uniapp/app/business/payment.md"},o=l(`<h1 id="第十四集-支付" tabindex="-1">第十四集 支付 <a class="header-anchor" href="#第十四集-支付" aria-label="Permalink to &quot;第十四集 支付&quot;">​</a></h1><h2 id="_1-前置条件" tabindex="-1">1. 前置条件 <a class="header-anchor" href="#_1-前置条件" aria-label="Permalink to &quot;1. 前置条件&quot;">​</a></h2><ul><li>需要配置好manifest.json文件的第三方支付模块</li><li>配置好后，需要重新打包自定义基座，才能生效</li></ul><h2 id="_2-微信支付" tabindex="-1">2. 微信支付 <a class="header-anchor" href="#_2-微信支付" aria-label="Permalink to &quot;2. 微信支付&quot;">​</a></h2><h3 id="_2-1-填写微信支付的appid" tabindex="-1">2.1. 填写微信支付的appid <a class="header-anchor" href="#_2-1-填写微信支付的appid" aria-label="Permalink to &quot;2.1. 填写微信支付的appid&quot;">​</a></h3><ul><li>安卓：打开项目的manifest.json文件，在“App模块配置”项的<strong>支付</strong>下，勾<strong>微信支付</strong>，将<a href="https://open.weixin.qq.com/" target="_blank" rel="noreferrer">微信开放平台</a>申请应用的AppID值填入“AppID”中</li><li>ios：打开项目的manifest.json文件，打开源码视图，找到<code>OAuth</code>项下的<code>UniversalLinks</code>，将<a href="https://open.weixin.qq.com/" target="_blank" rel="noreferrer">微信开放平台</a>申请应用的iOS平台通用链接值填入,必须与微信开放平台配置的一致</li><li>配置完成后进行打包自定义基座，才能生效</li></ul><h3 id="_2-2-调用微信支付" tabindex="-1">2.2. 调用微信支付 <a class="header-anchor" href="#_2-2-调用微信支付" aria-label="Permalink to &quot;2.2. 调用微信支付&quot;">​</a></h3><h4 id="_2-2-1-调用uni-requestpayment-发起支付" tabindex="-1">2.2.1. 调用uni.requestPayment()发起支付 <a class="header-anchor" href="#_2-2-1-调用uni-requestpayment-发起支付" aria-label="Permalink to &quot;2.2.1. 调用uni.requestPayment()发起支付&quot;">​</a></h4><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 以下参数均为示例，具体参数以实际为准,支付参数的获取需要在服务端进行</span></span>
<span class="line"><span style="color:#E1E4E8;">uni.</span><span style="color:#B392F0;">requestPayment</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;provider&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;wxpay&quot;</span><span style="color:#E1E4E8;">, </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;orderInfo&quot;</span><span style="color:#E1E4E8;">: {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;appid&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;wx499********7c70e&quot;</span><span style="color:#E1E4E8;">,  </span><span style="color:#6A737D;">// 微信开放平台 - 应用 - AppId，注意和微信小程序、公众号 AppId 可能不一致</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;noncestr&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;c5sEwbaNPiXAF3iv&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 随机字符串</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;package&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Sign=WXPay&quot;</span><span style="color:#E1E4E8;">,        </span><span style="color:#6A737D;">// 固定值</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;partnerid&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;148*****52&quot;</span><span style="color:#E1E4E8;">,      </span><span style="color:#6A737D;">// 微信支付商户号</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;prepayid&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;wx202254********************fbe90000&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 统一下单订单号 </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;timestamp&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">1597935292</span><span style="color:#E1E4E8;">,        </span><span style="color:#6A737D;">// 时间戳（单位：秒）</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;sign&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;A842B45937F6EFF60DEC7A2EAA52D5A0&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">// 签名，这里用的 MD5/RSA 签名</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">success</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">res</span><span style="color:#E1E4E8;">) {},</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">fail</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {}</span></span>
<span class="line"><span style="color:#E1E4E8;">})</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 以下参数均为示例，具体参数以实际为准,支付参数的获取需要在服务端进行</span></span>
<span class="line"><span style="color:#24292E;">uni.</span><span style="color:#6F42C1;">requestPayment</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;provider&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;wxpay&quot;</span><span style="color:#24292E;">, </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;orderInfo&quot;</span><span style="color:#24292E;">: {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;appid&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;wx499********7c70e&quot;</span><span style="color:#24292E;">,  </span><span style="color:#6A737D;">// 微信开放平台 - 应用 - AppId，注意和微信小程序、公众号 AppId 可能不一致</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;noncestr&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;c5sEwbaNPiXAF3iv&quot;</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 随机字符串</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;package&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Sign=WXPay&quot;</span><span style="color:#24292E;">,        </span><span style="color:#6A737D;">// 固定值</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;partnerid&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;148*****52&quot;</span><span style="color:#24292E;">,      </span><span style="color:#6A737D;">// 微信支付商户号</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;prepayid&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;wx202254********************fbe90000&quot;</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 统一下单订单号 </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;timestamp&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">1597935292</span><span style="color:#24292E;">,        </span><span style="color:#6A737D;">// 时间戳（单位：秒）</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;sign&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;A842B45937F6EFF60DEC7A2EAA52D5A0&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">// 签名，这里用的 MD5/RSA 签名</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">success</span><span style="color:#24292E;">(</span><span style="color:#E36209;">res</span><span style="color:#24292E;">) {},</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">fail</span><span style="color:#24292E;">(</span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {}</span></span>
<span class="line"><span style="color:#24292E;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_3-支付宝支付" tabindex="-1">3. 支付宝支付 <a class="header-anchor" href="#_3-支付宝支付" aria-label="Permalink to &quot;3. 支付宝支付&quot;">​</a></h2><h3 id="_3-1-配置支付宝支付" tabindex="-1">3.1. 配置支付宝支付 <a class="header-anchor" href="#_3-1-配置支付宝支付" aria-label="Permalink to &quot;3.1. 配置支付宝支付&quot;">​</a></h3><ul><li>打开项目的<code>manifest.json</code>文件，<strong>App模块配置</strong>项的<strong>支付</strong>下，勾<strong>支付宝支付</strong>即可</li></ul><h3 id="_3-2-调用支付宝支付" tabindex="-1">3.2 调用支付宝支付 <a class="header-anchor" href="#_3-2-调用支付宝支付" aria-label="Permalink to &quot;3.2 调用支付宝支付&quot;">​</a></h3><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 以下参数均为示例，具体参数以实际为准,支付参数的获取需要在服务端进行</span></span>
<span class="line"><span style="color:#E1E4E8;">uni.</span><span style="color:#B392F0;">requestPayment</span><span style="color:#E1E4E8;">({</span></span>
<span class="line"><span style="color:#E1E4E8;">    provider: </span><span style="color:#9ECBFF;">&#39;alipay&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    orderInfo: </span><span style="color:#9ECBFF;">&#39;orderInfo&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#6A737D;">// 支付宝订单数据(参数为字符串类型，与微信支付不同，字符串类型的数据类似微信支付对象进行生成拼接)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">success</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">res</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;success:&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">JSON</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#E1E4E8;">(res));</span></span>
<span class="line"><span style="color:#E1E4E8;">    },</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">fail</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;fail:&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">JSON</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">stringify</span><span style="color:#E1E4E8;">(err));</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">});</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 以下参数均为示例，具体参数以实际为准,支付参数的获取需要在服务端进行</span></span>
<span class="line"><span style="color:#24292E;">uni.</span><span style="color:#6F42C1;">requestPayment</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">    provider: </span><span style="color:#032F62;">&#39;alipay&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    orderInfo: </span><span style="color:#032F62;">&#39;orderInfo&#39;</span><span style="color:#24292E;">, </span><span style="color:#6A737D;">// 支付宝订单数据(参数为字符串类型，与微信支付不同，字符串类型的数据类似微信支付对象进行生成拼接)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">success</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">res</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;success:&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">JSON</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">stringify</span><span style="color:#24292E;">(res));</span></span>
<span class="line"><span style="color:#24292E;">    },</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">fail</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">err</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;fail:&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">JSON</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">stringify</span><span style="color:#24292E;">(err));</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_4-参考文档" tabindex="-1">4. 参考文档 <a class="header-anchor" href="#_4-参考文档" aria-label="Permalink to &quot;4. 参考文档&quot;">​</a></h2><ul><li><a href="https://uniapp.dcloud.net.cn/api/plugins/payment.html" target="_blank" rel="noreferrer">uni.requestPayment</a></li><li><a href="https://developers.weixin.qq.com/doc/oplatform/Mobile_App/WeChat_Pay/Vendor_Service_Center.html" target="_blank" rel="noreferrer">微信支付官方文档</a></li><li><a href="https://opendocs.alipay.com/open/204/105297/" target="_blank" rel="noreferrer">支付宝支付官方文档</a></li><li><a href="https://www.html5plus.org/doc/zh_cn/payment.html" target="_blank" rel="noreferrer">plus.payment</a></li></ul>`,16),e=[o];function r(t,c,E,i,y,u){return n(),a("div",null,e)}const q=s(p,[["render",r]]);export{F as __pageData,q as default};
